<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>„É¨„Ç∏‰ºöË®à</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
</head>
<body>
    <div id="app">
        <!-- HOME SCREEN -->
        <div v-if="currentView === 'home'" class="home-screen">
            <header class="header home-header">
                <div class="header-left">
                    <!-- No left content in image -->
                </div>
                <div class="header-center">
                    <span>„É°„Éã„É•„Éº</span>
                </div>
                <div class="header-right">
                    <span>{{ currentDate }}</span>
                    <span>{{ staffName }}</span>
                </div>
            </header>
            <div class="home-container">
                <aside class="sidebar">
                    <div class="sidebar-item" @click="navigateTo('tables')">
                        <div class="sidebar-text">„Ç™„Éº„ÉÄ„Éº„Éª<br>‰ºöË®à</div>
                        <div class="sidebar-icon">üõãÔ∏è</div> <!-- Placeholder icon -->
                    </div>
                    <div class="sidebar-item">
                        <div class="sidebar-text">Âç≥‰ºöË®à</div>
                        <div class="sidebar-icon">üì†</div> <!-- Placeholder icon -->
                    </div>
                    <div class="sidebar-item">
                        <div class="sidebar-text">‰ºùÁ•®ÊòéÁ¥∞</div>
                    </div>
                     <div class="sidebar-item has-arrow">
                        <div class="sidebar-text">ÂÖ•Âá∫Èáë</div>
                    </div>
                    <div class="sidebar-item">
                        <div class="sidebar-text">„Éâ„Ç¢„Ç™„Éº„Éó„É≥</div>
                    </div>
                    <div class="sidebar-item has-arrow">
                        <div class="sidebar-text">„É¨„Ç∏„ÇØ„É≠„Éº„Ç∫</div>
                    </div>
                     <div class="sidebar-item has-arrow">
                        <div class="sidebar-text">Ë®≠ÂÆö</div>
                    </div>

                    <div class="sidebar-footer" @click="console.log('logout')">
                         <span>‚Ü™ „É≠„Ç∞„Ç¢„Ç¶„Éà</span>
                    </div>
                </aside>
                <main class="home-main">
                    <div class="notification-bar">
                         <span class="notification-icon">‚úâ</span> „ÅäÁü•„Çâ„Åõ„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ
                    </div>
                    <div class="notification-line"></div>
                    <div class="clock-widget">
                        <div class="clock-circle">
                            <!-- Simple SVG or CSS circle -->
                             <div class="clock-hand hour-hand"></div>
                             <div class="clock-hand minute-hand"></div>
                        </div>
                        <div class="time-display">15:49</div>
                        <div class="weather-display">
                            <span class="weather-icon">‚òÅÔ∏è/‚òÄÔ∏è</span>
                            <span class="temp">9¬∞C</span>
                        </div>
                         <div class="footer-alert">
                            <span class="dots">‚óè ‚óè</span> <a href="#">„ÄêÈáçË¶Å„ÄëÂøÖ„Åö„ÅîÁ¢∫Ë™ç„Åè„Å†„Åï„ÅÑ üó®Ô∏è</a>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- TABLE LIST SCREEN -->
        <div v-if="currentView === 'tables'" class="tables-screen">
             <header class="header">
                <div class="header-left">
                    <span @click="navigateTo('home')">&lt; „É°„Éã„É•„Éº</span>
                </div>
                <div class="header-center">
                    <span>„ÉÜ„Éº„Éñ„É´‰∏ÄË¶ß</span>
                </div>
                <div class="header-right">
                    <span>{{ currentDate }}</span>
                    <span>{{ staffName }}</span>
                </div>
            </header>
            <div class="tables-container">
                <div class="table-grid">
                    <div v-for="table in tables" :key="table.id"
                         class="table-card"
                         :class="table.status"
                         @click="handleTableClick(table)">
                        <div class="table-header">
                            <span class="table-name">{{ table.name }}</span>
                            <span v-if="table.people > 0" class="table-people">üë§ {{ table.people }}</span>
                            <span v-if="table.amount > 0" class="table-amount-small">(¬•{{ table.amount.toLocaleString() }})</span>
                        </div>
                        <div class="table-body">
                             <div v-if="table.amount > 0" class="table-total">¬•{{ table.amount.toLocaleString() }}</div>
                             <div v-if="table.time" class="table-time">
                                <span>üì≤ {{ table.time }}</span>
                                <span class="duration">‚è±Ô∏è {{ table.duration }}</span>
                             </div>
                        </div>
                        <div class="table-footer" v-if="table.status !== 'empty'">
                            <span v-if="table.status === 'ordered' || table.status === 'ordered-alert'">„Ç™„Éº„ÉÄ„ÉºÊ∏à</span>
                            <span v-if="table.status === 'served'" style="background: #ffcc00; color: #333;">ÈÖçËÜ≥Ê∏à</span>
                            <span v-if="table.status === 'checkout'">ÂàÜÂâ≤‰ºöË®à‰∏≠</span>
                        </div>
                    </div>
                </div>
                <div class="tables-footer-actions">
                    <button class="btn-refresh">Êõ¥Êñ∞</button>
                </div>
            </div>

        </div>

        <!-- REGISTER SCREEN (Refactored) -->
        <div v-if="currentView === 'register'" class="register-screen">
             <header class="header register-header">
                <div class="header-left">
                    <span @click="navigateTo('tables')">&lt; „ÉÜ„Éº„Éñ„É´‰∏ÄË¶ß</span>
                </div>
                <div class="header-center">
                    <span style="font-size: 1.5rem;">üî∞</span>
                    <span>„É¨„Ç∏‰ºöË®à</span>
                </div>
                <div class="header-right">
                    <span>{{ currentDate }}</span>
                    <span>{{ staffName }}</span>
                </div>
            </header>

            <div class="main-container">
                <!-- Left Panel -->
                <div class="panel left-panel">
                    <div class="staff-row">
                        <span>ÊãÖÂΩìËÄÖ {{ staffName }}</span>
                        <button class="btn-settings">Ë®≠ÂÆö</button>
                    </div>

                    <div v-if="currentTable" class="table-info-section">
                        <div class="table-id-row">
                            <span class="table-id-large">{{ currentTable.name }}</span>
                            <span class="people-count-large">‰∫∫Êï∞ {{ currentTable.people }}</span>
                        </div>
                        <div class="customer-name-row">
                            <span class="label">È°ßÂÆ¢Âêç</span>
                            <!-- <div class="input-placeholder"></div> -->
                        </div>
                        <div class="split-check-button-row">
                            <button class="btn-split-check" @click="handleSplitCheck">‰ºùÁ•®ÂàÜÂâ≤</button>
                        </div>

                        <div class="order-list">
                            <div v-for="item in currentTable.items" class="order-item">
                                <span class="item-name">{{ item.name }}</span>
                                <span class="item-qty">{{ item.quantity }}ÂÄã</span>
                                <span class="item-price">¬•{{ item.price }} ></span>
                            </div>
                             <!-- If no items, show placeholder or nothing -->
                             <div v-if="!currentTable.items || currentTable.items.length === 0" style="color:#ccc; text-align:center; padding: 20px;">
                                 (Ê≥®Êñá„Å™„Åó)
                             </div>
                        </div>
                    </div>

                    <div class="left-bottom-buttons-new">
                        <button class="btn-order-orange" @click="handleOrder">Ê≥®Êñá</button>
                        <button class="btn-memo-white" @click="handleMemo">ÊîØÊâï„É°„É¢</button>
                        <button class="btn-info-white" @click="handleCustomerInfo">„ÅäÂÆ¢ÊßòÊÉÖÂ†±Ë®≠ÂÆö</button>
                    </div>
                </div>

                <!-- Center Panel -->
                <div class="panel center-panel">
                    <div class="summary-rows">
                        <div class="summary-row">
                            <span>Â∞èË®à</span>
                            <span>{{ formatCurrency(subtotal) }}</span>
                        </div>
                        <div class="summary-row">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <!-- Toggle Switch -->
                                <label class="switch">
                                  <input type="checkbox" v-model="isServiceChargeEnabled">
                                  <span class="slider round"></span>
                                </label>
                                <span>„Çµ„Éº„Éì„ÇπÊñôÈáë</span>
                            </div>
                            <span>{{ formatCurrency(serviceCharge) }}</span>
                        </div>
                        <div class="summary-row">
                            <span>Ê∑±Â§úÊñôÈáë</span>
                            <span>{{ formatCurrency(lateNightCharge) }}</span>
                        </div>
                        <div class="summary-row">
                            <span>ÂÄ§ÂºïÂºïË®à</span>
                            <span>{{ formatCurrency(discountTotal) }}</span>
                        </div>

                        <!-- Applied Discount List -->
                         <div v-if="discountList.length > 0" class="discount-list">
                            <div v-for="(discount, index) in discountList" :key="discount.id" class="discount-item">
                                <div class="discount-info">
                                    <span class="delete-icon" @click="removeDiscount(index)">‚úñ</span>
                                    <span class="discount-name">{{ discount.name }}</span>
                                    <span class="discount-value">{{ formatCurrency(getDiscountAmount(discount)) }}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="summary-divider-dashed"></div>

                    <div class="total-amount-row">
                        <span>„ÅäÊîØÊâï„ÅÑÈáëÈ°ç</span>
                        <span style="font-size: 1.5rem;">{{ formatCurrency(totalAmount) }}</span>
                    </div>
                    <div class="summary-row" style="color: #666; font-size: 0.9rem; margin-top: 5px;">
                        <span>Ê∂àË≤ªÁ®é</span>
                        <span>{{ formatCurrency(taxAmount) }}</span>
                    </div>

                    <div class="payment-list-area">
                        <div style="font-size: 0.9rem; color: #333; margin-bottom: 5px;">ÊîØÊâï</div>
                    </div>

                    <div class="summary-divider-dashed"></div>

                    <div class="bottom-summary-row text-blue">
                        <span>„ÅäÈ†ê„Åã„ÇäÈáëÈ°ç</span>
                        <span>{{ formatCurrency(receivedAmount) }}</span>
                    </div>
                    <div class="bottom-summary-row text-orange">
                        <span>ÊÆãÈ°ç</span>
                        <span>{{ formatCurrency(balanceAmount) }}</span>
                    </div>
                    <div class="summary-divider"></div>
                    <div class="bottom-summary-row text-bold" style="font-size: 1.2rem;">
                        <span>„Åä„Å§„Çä</span>
                        <span>{{ formatCurrency(changeAmount) }}</span>
                    </div>

                    <button class="btn-checkout-main" @click="handleCheckout">‰ºöË®à</button>
                </div>

                <!-- Right Panel (Mostly unchanged) -->
                <div class="panel right-panel">
                    <div class="top-action-buttons">
                        <button class="btn-action" @click="handleDiscount">ÂÄ§Ââ≤ÂºïÁôªÈå≤</button>
                        <button class="btn-action" @click="handleVoucher">ÈáëÂà∏</button>
                    </div>

                    <div class="summary-divider-dashed"></div>

                    <div class="payment-method-buttons">
                        <button class="btn-payment" :class="{ active: paymentMethod === 'cash' }" @click="setPaymentMethod('cash')">
                            ÁèæÈáë
                        </button>
                        <button class="btn-payment" :class="{ active: paymentMethod === 'other' }" @click="setPaymentMethod('other')">
                            „Åù„ÅÆ‰ªñÊîØÊâï
                        </button>
                    </div>

                    <div class="display-box">
                    </div>

                    <div class="black-bar">
                        {{ inputAmount }}
                    </div>

                    <div class="numpad">
                        <button class="btn-num clear" @click="handleClear">C</button>
                        <button class="btn-num balance" @click="handleBalance">ÊÆãÈ°ç</button>
                        <button class="btn-num disabled"></button>

                        <button class="btn-num" @click="handleNumClick('7')">7</button>
                        <button class="btn-num" @click="handleNumClick('8')">8</button>
                        <button class="btn-num" @click="handleNumClick('9')">9</button>

                        <button class="btn-num" @click="handleNumClick('4')">4</button>
                        <button class="btn-num" @click="handleNumClick('5')">5</button>
                        <button class="btn-num" @click="handleNumClick('6')">6</button>

                        <button class="btn-num" @click="handleNumClick('1')">1</button>
                        <button class="btn-num" @click="handleNumClick('2')">2</button>
                        <button class="btn-num" @click="handleNumClick('3')">3</button>

                        <button class="btn-num" @click="handleNumClick('0')">0</button>
                        <button class="btn-num" @click="handleNumClick('00')">00</button>
                        <button class="btn-num enter" @click="handleEnter">Ê±∫ÂÆö</button>
                    </div>
                </div>
            </div>
        </div>
            <!-- DISCOUNT REGISTRATION MODAL -->
            <div v-if="showDiscountModal" class="modal-overlay">
                <div class="discount-modal-content">
                    <div class="modal-header-row">
                         <span class="modal-title">ÂÄ§Ââ≤ÂºïÁôªÈå≤</span>
                         <div class="tab-group">
                             <div class="tab-item" :class="{ active: discountTab === 'value' }" @click="discountTab = 'value'">ÂÄ§Âºï</div>
                             <div class="tab-item" :class="{ active: discountTab === 'percent' }" @click="discountTab = 'percent'">Ââ≤Âºï</div>
                         </div>
                    </div>

                    <div class="preset-grid">
                        <div class="preset-btn" :class="{ selected: !selectedPreset }" @click="selectedPreset = null">
                            <span class="preset-label">{{ discountTab === 'value' ? 'ÂÄ§Âºï' : 'Ââ≤Âºï' }}</span>
                            <span class="preset-sub">ÊâãÂãïÂÖ•Âäõ</span>
                        </div>
                        <!-- Mock Presets -->
                        <div v-if="discountTab === 'value'" class="preset-btn" :class="{ selected: selectedPreset && selectedPreset.name === 'Á§æÂâ≤' }"
                             @click="selectedPreset = { name: 'Á§æÂâ≤', value: 500, type: 'value' }">
                             <span class="preset-label">Á§æÂâ≤</span>
                             <span class="preset-sub">¬•500</span>
                        </div>
                        <div v-if="discountTab === 'value'" class="preset-btn" :class="{ selected: selectedPreset && selectedPreset.name === '500ÂÜÜÂÄ§Âºï„Åç' }"
                             @click="selectedPreset = { name: '500ÂÜÜÂÄ§Âºï„Åç', value: 500, type: 'value' }">
                             <span class="preset-label">500ÂÜÜÂÄ§Âºï„Åç</span>
                             <span class="preset-sub">¬•500</span>
                        </div>
                         <div v-if="discountTab === 'value'" class="preset-btn" :class="{ selected: selectedPreset && selectedPreset.name === '1000ÂÜÜÂÄ§Âºï„Åç' }"
                             @click="selectedPreset = { name: '1000ÂÜÜÂÄ§Âºï„Åç', value: 1000, type: 'value' }">
                             <span class="preset-label">1000ÂÜÜÂÄ§Âºï„Åç</span>
                             <span class="preset-sub">¬•1,000</span>
                        </div>

                         <div v-if="discountTab === 'percent'" class="preset-btn" :class="{ selected: selectedPreset && selectedPreset.name === '10%Ââ≤Âºï' }"
                             @click="selectedPreset = { name: '10%Ââ≤Âºï', value: 10, type: 'percent' }">
                             <span class="preset-label">10%Ââ≤Âºï</span>
                        </div>
                        <div v-if="discountTab === 'percent'" class="preset-btn" :class="{ selected: selectedPreset && selectedPreset.name === '20%Ââ≤Âºï' }"
                             @click="selectedPreset = { name: '20%Ââ≤Âºï', value: 20, type: 'percent' }">
                             <span class="preset-label">20%Ââ≤Âºï</span>
                        </div>
                    </div>

                    <div class="discount-input-area">
                         <label v-if="!selectedPreset">
                            {{ discountTab === 'value' ? 'ÂÄ§Âºï„ÅÆÈ°ç (ÂÜÜ)' : 'Ââ≤Âºï„ÅÆÂÄ§ (%)' }}
                         </label>
                         <input v-if="!selectedPreset" type="number" v-model="discountInputValue" class="discount-input" />
                         <div v-else class="preset-selected-msg">
                             {{ selectedPreset.name }} ÈÅ∏Êäû‰∏≠
                         </div>
                    </div>

                    <div class="modal-footer-row">
                        <button class="btn-cancel-modal" @click="showDiscountModal = false">„Ç≠„É£„É≥„Çª„É´</button>
                        <button class="btn-ok-modal" @click="confirmDiscount">OK</button>
                    </div>
                </div>
            </div>

            <!-- CHECKOUT COMPLETE MODAL -->
            <div v-if="showCheckoutModal" class="modal-overlay">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>‰ºöË®àÂÆå‰∫Ü</h2>
                    </div>
                    <div class="modal-body">
                        <div class="modal-row">
                            <span class="label">„ÅäÊîØÊâï„ÅÑÈáëÈ°ç</span>
                            <span class="value">{{ formatCurrency(totalAmount) }}</span>
                        </div>
                         <div class="modal-divider-dotted"></div>
                        <div class="modal-row">
                            <span class="label">„ÅäÈ†ê„Åã„ÇäÈáëÈ°ç</span>
                            <span class="value">{{ formatCurrency(receivedAmount) }}</span>
                        </div>
                        <div class="modal-divider-dotted"></div>
                        <div class="modal-row">
                            <span class="label">„Åä„Å§„Çä</span>
                            <span class="value">{{ formatCurrency(changeAmount) }}</span>
                        </div>
                         <div class="modal-divider-dotted"></div>
                    </div>
                    <div class="modal-footer">
                        <div class="modal-buttons-row">
                            <button class="btn-blue-modal" @click="handleIssueReceipt">„É¨„Ç∑„Éº„ÉàÁô∫Ë°å</button>
                            <button class="btn-blue-modal" @click="handleGrantPoints">„Éù„Ç§„É≥„Éà‰ªò‰∏é</button>
                            <button class="btn-blue-modal" @click="handleIssueOfficialReceipt">È†òÂèéÊõ∏Áô∫Ë°å</button>
                        </div>
                        <div class="modal-buttons-row">
                            <button class="btn-white-modal" @click="closeCheckoutModal">„É°„Éã„É•„Éº</button>
                            <button class="btn-white-modal" @click="handleSlipDetails">‰ºùÁ•®ÊòéÁ¥∞</button>
                            <button class="btn-white-modal" @click="handleContinuousCheckout">ÈÄ£Á∂ö‰ºöË®à</button>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    <script src="js/app.js"></script>
</body>
</html>
